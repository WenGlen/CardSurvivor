# 卡片系統核心機制設計文件 v3.0

> 本文檔定義了 Survivor-X 遊戲的核心卡片堆疊系統，採用「順序依賴堆疊（Sequential Stacking）」機制，並依銅銀金分層邏輯區分卡片效益。
> **v3 核心變更**：移除純數值卡、強調順序差異、銅銀金分層定義重構。

---

## 1. 核心設計哲學：順序依賴堆疊（Sequential Stacking）

### 1.1 設計理念

不同於一般遊戲將所有加成「加總」後套用，本遊戲的技能強度取決於**卡片放入的先後順序**。這意味著：

- **順序即戰略**：先拿分裂再拿追蹤 → 只有母體追蹤；先拿追蹤再拿分裂 → 分裂後的碎片不追蹤
- **每張卡片都應強調順序差異**：設計時明確描述「先拿 A 再拿 B」與「先拿 B 再拿 A」的不同結果

### 1.2 無純數值卡原則

**純數值疊加類效果**（如縮短冷卻、增加數量、提升傷害、擴大範圍等）**不由卡片提供**，改由其他系統取得（裝備、藥水、升級等）。

卡片專注於**改變玩法**與**戰術定位**，而非單純變強。例如：
- ❌ 不設計「火球數量 +1」「冰箭冷卻 -0.2 秒」
- ✅ 改為「火球分裂成兩顆各 50% 傷害」「冰箭穿透後分裂成兩支小箭」

---

## 2. 銅銀金分層定義

### 2.1 等級與效益

| 等級 | 效益定位 | 核心差異 | 未來卡片是否套用 |
|------|----------|----------|------------------|
| **銅卡** | 玩法改變 | 總體數值不變，只改變運作方式 | **不會**套用到此卡效果 |
| **銀卡** | 傷害增加 | 提高最高總傷害/效益輸出 | **不會**套用到此卡效果 |
| **金卡** | 全局套用 | 效果可與未來卡片疊加 | **會**套用此卡效果 |

### 2.2 銅卡（Bronze）

- **定義**：不改變總體數值，只改變玩法
- **範例**：一支冰箭分裂成兩支，每支傷害 50% → 總傷害不變，覆蓋角度改變
- **範例**：冰錐附加追蹤功能，但不影響傷害與範圍
- **未來不套用**：後續取得的卡片（如數量、蔓延等）產生的新實例，**不會**繼承此銅卡的效果

### 2.3 銀卡（Silver）

- **定義**：增加最高的傷害總數值或整體效益
- **範例**：火球落地後彈起再炸一次，第二次傷害 60% → 總傷害 160%
- **範例**：冰箭穿透後分裂成 2 支小箭，每支 60% 傷害 → 總傷害 120%
- **未來不套用**：後續取得的卡片產生的新實例，**不會**套用此銀卡的效果

### 2.4 金卡（Gold）

- **定義**：未來效果也套用
- **範例**：冰錐追蹤效果（金卡版）→ 未來拿到的所有冰錐（含蔓延、地雷等衍生物）都會追蹤
- **範例**：極寒領域 → 未來拿到的分裂碎片擊中敵人也會產生寒氣區域
- **未來套用**：所有現有與未來產生的技能實例，**都會**套用此金卡的效果

### 2.5 比較表

| 情境 | 銅卡效果 | 銀卡效果 | 金卡效果 |
|------|----------|----------|----------|
| 先拿「冰錐追蹤」再拿「凍土蔓延」 | 蔓延的冰錐**不**追蹤 | 蔓延的冰錐**不**追蹤 | 蔓延的冰錐**會**追蹤 |
| 先拿「冰箭分裂」再拿「數量+2」* | 新加的 2 支箭**不**分裂 | 新加的 2 支箭**不**分裂 | 新加的 2 支箭**會**分裂 |
| 先拿「火球彈跳」再拿新火球卡* | 新火球**不**彈跳 | 新火球**不**彈跳 | 新火球**會**彈跳 |

\* 數量等純數值改由其他物品取得，此處僅作機制說明

---

## 3. 卡片效果類型與快照機制

### 3.1 順序依賴效果（銅卡、銀卡）

這類卡片的效果會受到放入順序的影響，且**不會**回溯修改已經產生的子體：

- **銅卡**：修改當前快照的「運作方式」，不改變總體數值；根據**當下快照**產生新實例時，新實例不繼承此卡
- **銀卡**：修改當前快照的「傷害/效益」，增加總輸出；根據**當下快照**產生新實例時，新實例不繼承此卡

### 3.2 全局效果（金卡）

- 不修改快照，而是**附加到所有實例**（現有和未來）上
- 無論何時放入，所有技能實例（含後續卡片產生的衍生物）都會套用

### 3.3 快照機制（Snapshot Mechanism）

- **技能實體（Skill Instance）**：每個卡槽維護「當前屬性快照（CurrentState）」
- **銅卡/銀卡**：直接修改快照，或根據「目前的快照」複製出新實例；**新實例不繼承此卡之後的其他銅/銀卡對母體的修改**
- **金卡**：不修改快照，附加到所有實例（現有與未來）

### 3.4 運作邏輯（線性演化模型）

1. **初始啟動**：玩家放入第一張卡片，開啟該技能類型，建立初始狀態
2. **銅卡/銀卡**：修改 `CurrentState` 或根據當下快照複製新實例；**此後放入的銅/銀卡只影響母體快照，不影響已產生的子體**
3. **金卡**：附加到所有實例（含未來產生的）
4. **後續隔離**：在此之後放入的銅/銀卡，只會修改 `CurrentState`（母體），**不會回溯修改已經產生的子體**

---

## 4. 順序互動範例

### 4.1 冰箭範例

**序列：寒冰穿刺（銅）→ 冰晶分裂（銅）→ 冰晶爆發（銀）**

1. 穿刺：現有冰箭穿透 +1、不衰減
2. 分裂：現有冰箭穿透後分裂成 2 支小箭，每支 50%（銅卡，總值不變）
3. 爆發：將分裂改為每支 60%（銀卡，總傷害 120%）

- 結果：母箭穿透後分裂成 2 支 60% 小箭
- 若**先拿分裂再拿穿刺**：母箭穿透後分裂，分裂的碎片**不**具穿透

### 4.2 火球範例

**序列：烈焰彈跳（銀）→ 拋物線分裂（銅）**

1. 彈跳：現有火球落地後彈起再炸，第二次 60% 傷害
2. 分裂：現有火球在飛行途中分裂成 2 顆，各 50%

- 結果：分裂後的**兩顆**火球各自落地、彈跳；每顆總傷害 160%
- 若**先拿分裂再拿彈跳**：只有**母體**（分裂前的那顆）彈跳，分裂後的兩顆**不**彈跳

### 4.3 電球範例（金卡套用）

**序列：閃電連線（銅）→ 特斯拉線圈（金）→ 電球數量 +1**（數量由他處取得，此處假設）

1. 連線：現有 2 顆電球之間產生閃電鏈
2. 特斯拉：所有電球（含未來）碰觸時 25% 機率釋放分支閃電
3. 數量 +1：新增 1 顆電球（來自他處）

- 結果：3 顆電球，**新電球與原有電球之間也會產生連線**（若連線為金卡則成立；但連線為銅卡時，新電球**不**產生連線）
- 3 顆電球**都會**觸發特斯拉分支閃電（金卡套用未來）

---

## 5. 系統基礎架構

### 5.1 槽位限制（Slot System）

- 主角擁有 **3 個固定卡槽**（Slot A, B, C）
- 每個卡槽只能放一種**技能類型**的卡片
- 可堆疊多張同類卡片（順序依賴）

### 5.2 卡片開啟機制

- 任一張卡片都可以是初始卡片
- 第一張卡片開啟該類型的攻擊方式
- 例如：第一張是「冰箭分裂（銅）」→ 開啟冰箭技能，得到 3 支可分裂的冰箭

### 5.3 堆疊計算規則

- **銅卡/銀卡**：修改快照或根據快照複製；**不影響已產生的子體**
- **金卡**：附加到所有實例（現有與未來），不修改快照

---

## 6. 技能參數池定義

（與 v2 相同，此處保留結構；純數值參數如數量、冷卻、半徑等主要由非卡片系統提供）

### 6.1 完整參數列表

| 參數名稱 | 說明 | 單位 |
|---------|------|------|
| `damage` | 基礎傷害值 | 點數 |
| `cooldown` | 兩次攻擊間的間隔時間 | 秒 |
| `duration` | 持續時間 | 秒 |
| `speed` | 移動/旋轉速度 | 像素/秒 或 度/秒 |
| `radius` | 範圍/半徑 | 像素 |
| `range` | 最大射程/作用距離 | 像素 |
| `angle` | 扇形角度 | 度 |
| `count` | 數量 | 個數 |
| `pierceCount` | 穿透力 | 次數 |
| `bounceCount` | 彈跳次數 | 次數 |
| `splitCount` | 分裂數 | 次數 |
| `spreadAngle` | 散射角度 | 度 |
| `knockback` | 擊退距離 | 像素 |
| `chance` | 機率值 | 0-1 |
| `slowRate` | 減速比例 | 0-1 |
| `captureLimit` | 囚禁數量上限 | 個數 |
| `chainCount` | 連鎖跳躍次數 | 次數 |
| `pullForce` | 吸引力強度 | 數值 |
| `tickRate` | 持續傷害的觸發頻率 | 次/秒 |
| `falloffRatio` | 隨距離衰減率 | 0-1 |
| `invincibleTime` | 無敵時間 | 秒 |
| `castRange` | 施法距離 | 像素 |

### 6.2 元素屬性、傷害類型、技能名稱

（與 Cards-v2 相同，參照原文件 3.2、3.3 節）

---

## 7. 設計檢核清單

在設計或審核卡片時，可依以下三點檢視：

1. **無純數值卡**：是否僅增加數值（冷卻、數量、傷害、半徑等）而無玩法改變？若是，應移出卡片系統
2. **順序差異**：是否明確描述「先拿 A 再拿 B」與「先拿 B 再拿 A」的不同？每張卡都應有順序互動說明
3. **銅銀金分層**：銅卡總值不變、銀卡總傷增加、金卡未來套用，是否符合此卡的等級定義？

---

**版本**：v3.0  
**設計重點**：無純數值卡・順序即戰略・銅銀金分層  
**關聯文件**：CardsDetail-v2.md
